<?xml version="1.0" encoding="UTF-8"?>
<!-- WiX installer for UltraSearch UI (unsigned). Build with `cargo wix` inside crates/ui`. -->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product
      Id="*"
      Name="UltraSearch"
      Language="1033"
      Version="0.1.0"
      Manufacturer="Ultrasearch Team"
      UpgradeCode="F5B2C1A2-5BC0-4C5D-93E4-0D6F9A6C9E11">

    <Package
        InstallerVersion="500"
        Compressed="yes"
        InstallScope="perMachine"
        InstallPrivileges="elevated" />

    <MajorUpgrade DowngradeErrorMessage="A newer version of UltraSearch is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <!-- Application directories -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="UltraSearch" />
      </Directory>
      <Directory Id="ProgramMenuFolder">
        <Directory Id="ApplicationProgramsFolder" Name="UltraSearch" />
      </Directory>
      <Directory Id="DesktopFolder" />
    </Directory>

    <!-- Files -->
    <DirectoryRef Id="INSTALLFOLDER">
      <Component Id="cmp_ui_exe" Guid="*">
        <File Id="fil_ui_exe" Source="$(var.CargoTargetBinDir)\ui.exe" KeyPath="yes" />
        <Shortcut Id="sc_startmenu"
                  Directory="ApplicationProgramsFolder"
                  Name="UltraSearch"
                  WorkingDirectory="INSTALLFOLDER"
                  Advertise="yes"
                  Description="UltraSearch desktop search" />
        <Shortcut Id="sc_desktop"
                  Directory="DesktopFolder"
                  Name="UltraSearch"
                  WorkingDirectory="INSTALLFOLDER"
                  Advertise="yes"
                  Description="UltraSearch desktop search" />
      </Component>
    </DirectoryRef>

    <!-- Features -->
    <Feature Id="MainFeature" Title="UltraSearch" Level="1">
      <ComponentRef Id="cmp_ui_exe" />
    </Feature>

    <!-- ARP metadata -->
    <Property Id="ARPHELPLINK" Value="https://github.com/Dicklesworthstone/ultrasearch/issues" />
    <Property Id="ARPURLINFOABOUT" Value="https://github.com/Dicklesworthstone/ultrasearch" />
    <Property Id="ARPINSTALLLOCATION" Value="[INSTALLFOLDER]" />

  </Product>
</Wix>
